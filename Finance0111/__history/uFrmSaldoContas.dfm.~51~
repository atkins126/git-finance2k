object frmSaldoContas: TfrmSaldoContas
  Left = 0
  Top = 0
  Caption = 'Saldo das Contas Banc'#225'rias'
  ClientHeight = 599
  ClientWidth = 1402
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  inline frmContaBancaria1: TfrmContaBancaria
    Left = 311
    Top = 38
    Width = 243
    Height = 114
    TabOrder = 0
    ExplicitLeft = 311
    ExplicitTop = 38
  end
  object dbgrd1: TDBGrid
    Left = 8
    Top = 192
    Width = 1386
    Height = 337
    DataSource = dsSaldo
    TabOrder = 1
    TitleFont.Charset = DEFAULT_CHARSET
    TitleFont.Color = clWindowText
    TitleFont.Height = -11
    TitleFont.Name = 'Tahoma'
    TitleFont.Style = []
    Columns = <
      item
        Expanded = False
        FieldName = 'CONTA'
        Width = 69
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'JANEIRO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'FEVEREIRO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'MARCO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'ABRIL'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'MAIO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'JUNHO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'JULHO'
        Width = 100
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'AGOSTO'
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'SETEMBRO'
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'OUTUBRO'
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'NOVEMBRO'
        Visible = True
      end
      item
        Expanded = False
        FieldName = 'DEZEMBRO'
        Visible = True
      end>
  end
  object btnProcessarSaldo: TButton
    Left = 584
    Top = 33
    Width = 145
    Height = 45
    Caption = 'Processar'
    TabOrder = 2
    OnClick = btnProcessarSaldoClick
  end
  inline frmPeriodo1: TfrmPeriodo
    Left = 24
    Top = 16
    Width = 281
    Height = 89
    TabOrder = 3
    ExplicitLeft = 24
    ExplicitTop = 16
    ExplicitWidth = 281
    ExplicitHeight = 89
    inherited lbl1: TLabel
      Top = 22
      ExplicitTop = 22
    end
    inherited lbl2: TLabel
      Top = 22
      ExplicitTop = 22
    end
    inherited dtpDataInicial: TDateTimePicker
      Top = 41
      ExplicitTop = 41
    end
    inherited dtpDataFinal: TDateTimePicker
      Top = 41
      ExplicitTop = 41
    end
  end
  object btnImprimir: TButton
    Left = 584
    Top = 107
    Width = 145
    Height = 45
    Caption = 'Imprimir'
    TabOrder = 4
    OnClick = btnImprimirClick
  end
  object dsSaldo: TDataSource
    DataSet = qrySaldosBancarios
    Left = 592
    Top = 248
  end
  object qryCRTodasPeriodo: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      'SELECT SUM(CBC.valor) AS VALOR_CR'
      ''
      'FROM conta_bancaria_credito CBC'
      ''
      
        'WHERE (CBC.data_movimento BETWEEN :pDataInicial AND :pDataFinal)' +
        ' AND'
      '      (CBC.id_organizacao = :PIDORGANIZACAO) AND'
      '      (CBC.id_conta_bancaria = :PIDCONTA)'
      'GROUP BY cbc.data_movimento')
    Left = 800
    Top = 544
    ParamData = <
      item
        Name = 'PDATAINICIAL'
        DataType = ftDate
        ParamType = ptInput
      end
      item
        Name = 'PDATAFINAL'
        DataType = ftDate
        ParamType = ptInput
      end
      item
        Name = 'PIDORGANIZACAO'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end
      item
        Name = 'PIDCONTA'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end>
  end
  object qryObterConta: TFDQuery
    Connection = dmConexao.conn
    SQL.Strings = (
      'SELECT'
      '     CB.ID_CONTA_BANCARIA,'
      '     CB.CONTA,'
      '     CB.AGENCIA,'
      '     CB.TITULAR,'
      '     CB.SALDO_INICIAL,'
      '     CB.ID_CONTA_CONTABIL,'
      '     CC.CONTA AS CONTA_CONT,'
      '     CC.DESCRICAO AS DSC_CONT,'
      '     CC.CODREDUZ AS COD_CONT'
      ''
      ' FROM CONTA_BANCARIA CB'
      
        'LEFT OUTER JOIN CONTA_CONTABIL CC ON (CC.ID_CONTA_CONTABIL = CB.' +
        'ID_CONTA_CONTABIL) AND (CC.ID_ORGANIZACAO = CB.ID_ORGANIZACAO)'
      
        'WHERE (CB.ID_CONTA_BANCARIA = :PIDCONTA) AND (CB.ID_ORGANIZACAO ' +
        '= :PIDORGANIZACAO)'
      ''
      '')
    Left = 432
    Top = 544
    ParamData = <
      item
        Name = 'PIDCONTA'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end
      item
        Name = 'PIDORGANIZACAO'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end>
  end
  object qrySaldosBancarios: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      'SELECT'
      '     CB.ID_CONTA_BANCARIA,'
      '     CB.CONTA,     '
      '     CB.TITULAR,'
      '     CBS.ANO,'
      '     CBS.JANE AS JANEIRO,'
      '     CBS.FEVE AS FEVEREIRO,'
      '     CBS.MARC AS MARCO,'
      '     CBS.ABRI AS ABRIL,'
      '     CBS.MAIO AS MAIO,'
      '     CBS.JUNH AS JUNHO,'
      '     CBS.JULH AS JULHO,'
      '     CBS.AGOS AS AGOSTO,'
      '     CBS.SETE AS SETEMBRO,'
      '     CBS.OUTU AS OUTUBRO,'
      '     CBS.NOVE AS NOVEMBRO,'
      '     CBS.DEZE AS DEZEMBRO'
      ''
      ''
      ''
      'FROM CONTA_BANCARIA_SALDO CBS'
      ''
      ''
      
        'LEFT OUTER JOIN CONTA_BANCARIA CB  ON (CB.ID_CONTA_BANCARIA = CB' +
        'S.ID_CONTA_BANCARIA)'
      ''
      'WHERE 1=1'
      ''
      'ORDER BY CBS.ANO, CB.CONTA'
      ''
      '')
    Left = 936
    Top = 544
  end
  object qryObterTodasContas: TFDQuery
    Connection = dmConexao.conn
    SQL.Strings = (
      'SELECT'
      '     CB.ID_CONTA_BANCARIA,'
      '     CB.CONTA,'
      '     CB.AGENCIA,'
      '     CB.TITULAR,'
      '     CB.SALDO_INICIAL,'
      '     CB.ID_CONTA_CONTABIL'
      ''
      ''
      'FROM CONTA_BANCARIA CB'
      'WHERE (CB.ID_ORGANIZACAO = :PIDORGANIZACAO)'
      ''
      '')
    Left = 568
    Top = 544
    ParamData = <
      item
        Name = 'PIDORGANIZACAO'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end>
  end
  object qryDBTodasPeriodo: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      'SELECT SUM(CBD.valor) AS VALOR_DB'
      ''
      'FROM CONTA_BANCARIA_DEBITO CBD'
      ''
      
        'WHERE (CBD.data_movimento BETWEEN :pDataInicial AND :pDataFinal)' +
        ' AND'
      '      (CBD.id_organizacao = :PIDORGANIZACAO) AND'
      '      (CBD.id_conta_bancaria = :PIDCONTA)'
      ''
      'GROUP BY CBD.data_movimento')
    Left = 688
    Top = 552
    ParamData = <
      item
        Name = 'PDATAINICIAL'
        DataType = ftDate
        ParamType = ptInput
      end
      item
        Name = 'PDATAFINAL'
        DataType = ftDate
        ParamType = ptInput
      end
      item
        Name = 'PIDORGANIZACAO'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end
      item
        Name = 'PIDCONTA'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end>
  end
  object qryLimpaDataset: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      'DELETE FROM  CONTA_BANCARIA_SALDO WHERE 1=1')
    Left = 88
    Top = 536
  end
  object qryPreparaDataset: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      
        'INSERT INTO CONTA_BANCARIA_SALDO (ID_CONTA_BANCARIA, ANO) VALUES' +
        ' ( :PIDCONTA, :PANO);'
      '')
    Left = 200
    Top = 536
    ParamData = <
      item
        Name = 'PIDCONTA'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end
      item
        Name = 'PANO'
        DataType = ftString
        ParamType = ptInput
        Size = 4
      end>
  end
  object qryInsereSaldoConta: TFDQuery
    Connection = dmConexao.conn
    FormatOptions.AssignedValues = [fvFmtDisplayNumeric, fvFmtEditNumeric]
    FormatOptions.FmtDisplayNumeric = '###,##0.00'
    FormatOptions.FmtEditNumeric = '###,##0.00'
    SQL.Strings = (
      
        'INSERT INTO CONTA_BANCARIA_SALDO (ID_CONTA_BANCARIA, ANO) VALUES' +
        ' ( :PIDCONTA, :PANO);'
      '')
    Left = 320
    Top = 544
    ParamData = <
      item
        Name = 'PIDCONTA'
        DataType = ftString
        ParamType = ptInput
        Size = 36
      end
      item
        Name = 'PANO'
        DataType = ftString
        ParamType = ptInput
        Size = 4
      end>
  end
end
