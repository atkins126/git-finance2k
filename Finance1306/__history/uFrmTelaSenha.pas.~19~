unit uFrmTelaSenha;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Buttons,
  uUsuarioDAO, uUsuarioModel, udmConexao, MDModel, MDDAO, uUtil, uConstantes,
  EMsgDlg, cxGraphics, cxControls, cxLookAndFeels, cxLookAndFeelPainters,
  dxSkinsCore, dxSkinsDefaultPainters, dxStatusBar ;

type
  TfrmTelaSenha = class(TForm)
    edtPassword: TEdit;
    btnConfirma: TBitBtn;
    PempecMsg: TEvMsgDlg;
    edtUsuario: TEdit;
    lblUser: TLabel;
    dxStatusBar: TdxStatusBar;
    Label1: TLabel;
    procedure btnConfirmaClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
    sucesso : Boolean;
    autorizado : Boolean;
    function verificaSenha(senha :string) :Boolean;

  public
    { Public declarations }
   function getAutorizado() : Boolean;
   constructor Create(AOwner: TComponent; usuario :TUsuarioModel);  overload;


  end;

var
  frmTelaSenha: TfrmTelaSenha;

implementation

{$R *.dfm}

{ TfrmTelaSenha }

procedure TfrmTelaSenha.btnConfirmaClick(Sender: TObject);
begin

  if verificaSenha(edtPassword.Text) then begin

   autorizado := True;
   PempecMsg.MsgInformation('Funções liberadas.')

  end;

    PostMessage(Self.Handle, WM_CLOSE, 0, 0);


end;

constructor TfrmTelaSenha.Create(AOwner: TComponent; usuario: TUsuarioModel);
begin
inherited Create(AOwner);
  autorizado := False;
  sucesso := False;

  if usuario <> nil then
  begin

    if not uutil.Empty(usuario.Fnome) then
    begin

      edtUsuario.Text := usuario.Fnome;

    end;

  end;

end;

procedure TfrmTelaSenha.FormClose(Sender: TObject; var Action: TCloseAction);
begin
Action := caFree;
end;

function TfrmTelaSenha.getAutorizado: Boolean;
begin

Result := autorizado;

end;

function TfrmTelaSenha.verificaSenha(senha: string): Boolean;
begin

  autorizado := False;
  sucesso := False;

  if not uutil.Empty(senha) then
  begin

    if senha.Equals(uConstantes.getSenhaPadrao) then
    begin

      autorizado := True;
      sucesso := True;

    end;

  end;

  Result := autorizado;

end;

end.
